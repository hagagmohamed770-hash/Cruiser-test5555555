# نظام إدارة الاستثمار العقاري - الإصدار 5.0.0

نظام شامل ومتطور لإدارة الاستثمارات العقارية مبني على Node.js مع قاعدة بيانات SQLite وواجهة مستخدم حديثة.

## 🚀 الميزات الجديدة في الإصدار 5.0.0

### ✨ التحسينات الرئيسية
- **قاعدة بيانات SQLite**: استبدال IndexedDB بقاعدة بيانات SQLite أكثر استقراراً وأداءً
- **خادم Express**: بنية خادم قوية مع API RESTful
- **نظام مصادقة متقدم**: JWT tokens مع تشفير كلمات المرور
- **واجهة مستخدم حديثة**: تصميم متجاوب مع دعم الوضع الداكن والفاتح
- **سجل التغييرات**: تتبع جميع العمليات في النظام
- **نسخ احتياطية**: نظام نسخ احتياطية متقدم مع استعادة البيانات
- **تقارير شاملة**: تقارير مالية وإدارية مفصلة مع رسوم بيانية

### 🔧 الميزات التقنية
- **أمان متقدم**: Helmet.js, CORS, Rate Limiting
- **ضغط البيانات**: Gzip compression للأداء الأفضل
- **معالجة الأخطاء**: نظام معالجة أخطاء شامل
- **API Documentation**: توثيق كامل للـ API
- **Testing**: اختبارات شاملة للوظائف
- **Logging**: نظام تسجيل متقدم

## 📋 المتطلبات

### النظام
- Node.js 16.0.0 أو أحدث
- npm أو yarn
- متصفح ويب حديث

### التبعيات
```json
{
  "express": "^4.18.2",
  "sqlite3": "^5.1.6",
  "bcryptjs": "^2.4.3",
  "jsonwebtoken": "^9.0.2",
  "helmet": "^7.1.0",
  "cors": "^2.8.5",
  "compression": "^1.7.4",
  "express-rate-limit": "^7.1.5"
}
```

## 🛠️ التثبيت والتشغيل

### 1. تثبيت التبعيات
```bash
npm install
```

### 2. تهيئة قاعدة البيانات
```bash
npm run init-db
```

### 3. تشغيل الخادم
```bash
# للتطوير
npm run dev

# للإنتاج
npm start
```

### 4. الوصول للتطبيق
افتح المتصفح واذهب إلى: `http://localhost:3000`

### بيانات تسجيل الدخول الافتراضية
- **اسم المستخدم**: `admin`
- **كلمة المرور**: `admin123`

## 📁 هيكل المشروع

```
real-estate-management-system/
├── server.js                 # نقطة بداية الخادم
├── package.json             # تبعيات المشروع
├── database/
│   └── database.js          # إدارة قاعدة البيانات
├── routes/                  # مسارات API
│   ├── auth.js             # المصادقة
│   ├── customers.js        # العملاء
│   ├── units.js            # الوحدات
│   ├── contracts.js        # العقود
│   ├── installments.js     # الأقساط
│   ├── partners.js         # الشركاء
│   ├── brokers.js          # السماسرة
│   ├── vouchers.js         # السندات
│   ├── treasury.js         # الخزينة
│   ├── reports.js          # التقارير
│   ├── audit.js            # سجل التغييرات
│   └── backup.js           # النسخ الاحتياطية
├── utils/
│   └── audit.js            # نظام سجل التغييرات
├── public/                 # الملفات العامة
│   ├── index.html          # الصفحة الرئيسية
│   ├── style.css           # التصميم
│   └── app.js              # JavaScript الأمامي
├── data/                   # قاعدة البيانات
│   └── estate_management.db
└── backups/                # النسخ الاحتياطية
```

## 🗄️ قاعدة البيانات

### الجداول الرئيسية
- **customers**: بيانات العملاء
- **units**: الوحدات العقارية
- **contracts**: العقود
- **installments**: الأقساط
- **partners**: الشركاء
- **brokers**: السماسرة
- **vouchers**: السندات
- **safes**: الخزائن
- **transfers**: التحويلات
- **audit_log**: سجل التغييرات
- **users**: المستخدمين

### العلاقات
- العميل يمكن أن يكون له عدة عقود
- الوحدة يمكن أن تكون مرتبطة بعدة شركاء
- العقد يحتوي على عدة أقساط
- كل عملية تُسجل في سجل التغييرات

## 🔐 الأمان

### المصادقة والتفويض
- JWT tokens للمصادقة
- تشفير كلمات المرور باستخدام bcrypt
- التحقق من صلاحيات المستخدم
- Rate limiting لمنع الهجمات

### حماية البيانات
- Helmet.js لحماية HTTP headers
- CORS للتحكم في الوصول
- معالجة آمنة للبيانات المدخلة
- تشفير البيانات الحساسة

## 📊 التقارير

### أنواع التقارير
1. **تقرير لوحة التحكم**: نظرة عامة على النظام
2. **تقرير المبيعات**: تحليل المبيعات والإيرادات
3. **تقرير الإيجارات**: تحليل العقود الإيجارية
4. **تقرير الأقساط**: حالة الأقساط والمدفوعات
5. **تقرير الشركاء**: تحليل الشركاء وحصصهم
6. **تقرير الخزينة**: التدفقات النقدية

### الرسوم البيانية
- رسوم خطية للمبيعات الشهرية
- رسوم دائرية لتوزيع الوحدات
- رسوم شريطية للإيرادات
- رسوم منطقة للتحليل الزمني

## 💾 النسخ الاحتياطية

### الميزات
- نسخ احتياطية تلقائية
- نسخ احتياطية يدوية
- استعادة البيانات
- تصدير البيانات بصيغ مختلفة
- تشفير النسخ الاحتياطية

### الأوامر
```bash
# إنشاء نسخة احتياطية
npm run backup

# استعادة نسخة احتياطية
npm run restore
```

## 🔧 الإعدادات

### متغيرات البيئة
```env
NODE_ENV=development
PORT=3000
JWT_SECRET=your-secret-key
```

### إعدادات قاعدة البيانات
- **النوع**: SQLite
- **الموقع**: `./data/estate_management.db`
- **النسخ الاحتياطية**: `./backups/`

## 🧪 الاختبارات

### تشغيل الاختبارات
```bash
npm test
```

### أنواع الاختبارات
- اختبارات الوحدة
- اختبارات التكامل
- اختبارات API
- اختبارات الواجهة

## 📱 الواجهة الأمامية

### الميزات
- تصميم متجاوب
- دعم الوضع الداكن والفاتح
- واجهة عربية كاملة
- اختصارات لوحة المفاتيح
- إشعارات فورية

### المكتبات المستخدمة
- Chart.js للرسوم البيانية
- HTMX للتفاعل
- XLSX.js لتصدير البيانات

## 🚀 النشر

### Docker
```dockerfile
FROM node:16-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

### PM2
```bash
npm install -g pm2
pm2 start server.js --name "real-estate-app"
```

## 🔄 التحديثات

### الإصدار 5.0.0 (الحالي)
- إعادة كتابة كاملة للنظام
- قاعدة بيانات SQLite
- خادم Express
- واجهة مستخدم حديثة
- نظام أمان متقدم

### الإصدارات السابقة
- 4.0.0: PWA مع IndexedDB
- 3.0.0: تحسينات الأداء
- 2.0.0: إضافة التقارير
- 1.0.0: الإصدار الأول

## 🆘 الدعم والمساعدة

### المشاكل الشائعة
1. **خطأ في الاتصال بقاعدة البيانات**
   - تأكد من وجود مجلد `data`
   - تحقق من صلاحيات الكتابة

2. **مشاكل في المصادقة**
   - تحقق من JWT_SECRET
   - أعد إنشاء المستخدم الافتراضي

3. **مشاكل في الأداء**
   - تحقق من إعدادات قاعدة البيانات
   - استخدم النسخ الاحتياطية

### للحصول على المساعدة
- راجع هذا الملف
- تحقق من سجل الأخطاء
- اتصل بالدعم الفني

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT.

## 🤝 المساهمة

نرحب بالمساهمات! يرجى:
1. Fork المشروع
2. إنشاء فرع للميزة الجديدة
3. Commit التغييرات
4. Push للفرع
5. إنشاء Pull Request

## 📞 الاتصال

- **المطور**: Jules
- **البريد الإلكتروني**: support@example.com
- **الموقع**: https://example.com

---

**تم التطوير بواسطة**: Jules  
**آخر تحديث**: 2025-01-27  
**الإصدار**: 5.0.0
